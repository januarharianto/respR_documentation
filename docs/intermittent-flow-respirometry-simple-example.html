<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>9 Intermittent-flow respirometry: Simple example | respR – R Package Documentation</title>
  <meta name="description" content="Documentation for the R package, respR.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="9 Intermittent-flow respirometry: Simple example | respR – R Package Documentation" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Documentation for the R package, respR." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 Intermittent-flow respirometry: Simple example | respR – R Package Documentation" />
  
  <meta name="twitter:description" content="Documentation for the R package, respR." />
  

<meta name="author" content="Januar Harianto and Nicholas Carey">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="comparative-performance-of-auto-rate-and-lolinr.html">
<link rel="next" href="intermittent-flow-respirometry-complex-example.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">respR - Documentation</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="installation.html"><a href="installation.html"><i class="fa fa-check"></i><b>2</b> Installation</a></li>
<li class="part"><span><b>VIGNETTES</b></span></li>
<li class="chapter" data-level="3" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>3</b> Getting started</a><ul>
<li class="chapter" data-level="3.1" data-path="getting-started.html"><a href="getting-started.html#aquatic-respirometry"><i class="fa fa-check"></i><b>3.1</b> Aquatic Respirometry</a></li>
<li class="chapter" data-level="3.2" data-path="getting-started.html"><a href="getting-started.html#the-respr-r-package"><i class="fa fa-check"></i><b>3.2</b> The <code>respR</code> R package</a></li>
<li class="chapter" data-level="3.3" data-path="getting-started.html"><a href="getting-started.html#example-data"><i class="fa fa-check"></i><b>3.3</b> Example Data</a></li>
<li class="chapter" data-level="3.4" data-path="getting-started.html"><a href="getting-started.html#vignettes-and-documentation"><i class="fa fa-check"></i><b>3.4</b> Vignettes and documentation</a></li>
<li class="chapter" data-level="3.5" data-path="getting-started.html"><a href="getting-started.html#references"><i class="fa fa-check"></i><b>3.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="importing-data.html"><a href="importing-data.html"><i class="fa fa-check"></i><b>4</b> Importing data</a><ul>
<li class="chapter" data-level="4.1" data-path="importing-data.html"><a href="importing-data.html#import_file"><i class="fa fa-check"></i><b>4.1</b> <code>import_file()</code></a></li>
<li class="chapter" data-level="4.2" data-path="importing-data.html"><a href="importing-data.html#format_time"><i class="fa fa-check"></i><b>4.2</b> <code>format_time()</code></a></li>
<li class="chapter" data-level="4.3" data-path="importing-data.html"><a href="importing-data.html#dealing-with-timed-events-or-notes"><i class="fa fa-check"></i><b>4.3</b> Dealing with timed events or notes</a></li>
<li class="chapter" data-level="4.4" data-path="importing-data.html"><a href="importing-data.html#next-steps"><i class="fa fa-check"></i><b>4.4</b> Next steps</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="closed-chamber-respirometry.html"><a href="closed-chamber-respirometry.html"><i class="fa fa-check"></i><b>5</b> Closed-chamber respirometry</a><ul>
<li class="chapter" data-level="5.1" data-path="closed-chamber-respirometry.html"><a href="closed-chamber-respirometry.html#a-typical-respr-workflow-closed-chamber-respirometry"><i class="fa fa-check"></i><b>5.1</b> A typical respR workflow: Closed-chamber respirometry</a></li>
<li class="chapter" data-level="5.2" data-path="closed-chamber-respirometry.html"><a href="closed-chamber-respirometry.html#step-1-check-for-common-errors"><i class="fa fa-check"></i><b>5.2</b> Step 1: Check for common errors</a></li>
<li class="chapter" data-level="5.3" data-path="closed-chamber-respirometry.html"><a href="closed-chamber-respirometry.html#step-2-process-background-respiration"><i class="fa fa-check"></i><b>5.3</b> Step 2: Process background respiration</a></li>
<li class="chapter" data-level="5.4" data-path="closed-chamber-respirometry.html"><a href="closed-chamber-respirometry.html#step-3-calculate-oxygen-uptake-rate"><i class="fa fa-check"></i><b>5.4</b> Step 3: Calculate oxygen uptake rate</a></li>
<li class="chapter" data-level="5.5" data-path="closed-chamber-respirometry.html"><a href="closed-chamber-respirometry.html#step-4-adjust-for-background-respiration"><i class="fa fa-check"></i><b>5.5</b> Step 4: Adjust for background respiration</a></li>
<li class="chapter" data-level="5.6" data-path="closed-chamber-respirometry.html"><a href="closed-chamber-respirometry.html#step-5-convert-the-results"><i class="fa fa-check"></i><b>5.6</b> Step 5: Convert the results</a></li>
<li class="chapter" data-level="5.7" data-path="closed-chamber-respirometry.html"><a href="closed-chamber-respirometry.html#summary"><i class="fa fa-check"></i><b>5.7</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="using-auto-rate.html"><a href="using-auto-rate.html"><i class="fa fa-check"></i><b>6</b> Using <code>auto_rate()</code></a></li>
<li class="chapter" data-level="7" data-path="performance-in-detecting-linear-regions.html"><a href="performance-in-detecting-linear-regions.html"><i class="fa fa-check"></i><b>7</b> Performance in detecting linear regions</a></li>
<li class="chapter" data-level="8" data-path="comparative-performance-of-auto-rate-and-lolinr.html"><a href="comparative-performance-of-auto-rate-and-lolinr.html"><i class="fa fa-check"></i><b>8</b> Comparative performance of <code>auto_rate()</code> and <code>LoLinR</code></a></li>
<li class="chapter" data-level="9" data-path="intermittent-flow-respirometry-simple-example.html"><a href="intermittent-flow-respirometry-simple-example.html"><i class="fa fa-check"></i><b>9</b> Intermittent-flow respirometry: Simple example</a></li>
<li class="chapter" data-level="10" data-path="intermittent-flow-respirometry-complex-example.html"><a href="intermittent-flow-respirometry-complex-example.html"><i class="fa fa-check"></i><b>10</b> Intermittent-flow respirometry: Complex example</a></li>
<li class="chapter" data-level="11" data-path="flowthrough-respirometry.html"><a href="flowthrough-respirometry.html"><i class="fa fa-check"></i><b>11</b> Flowthrough respirometry</a></li>
<li class="chapter" data-level="12" data-path="pcrit.html"><a href="pcrit.html"><i class="fa fa-check"></i><b>12</b> P<sub>crit</sub></a></li>
<li class="chapter" data-level="13" data-path="two-point-analyses.html"><a href="two-point-analyses.html"><i class="fa fa-check"></i><b>13</b> Two-point analyses</a></li>
<li class="chapter" data-level="14" data-path="open-science-and-reproducibility-using-respr.html"><a href="open-science-and-reproducibility-using-respr.html"><i class="fa fa-check"></i><b>14</b> Open science and reproducibility using respR</a></li>
<li class="chapter" data-level="15" data-path="respr-and-the-tidyverse.html"><a href="respr-and-the-tidyverse.html"><i class="fa fa-check"></i><b>15</b> respR and the tidyverse</a><ul>
<li class="chapter" data-level="15.1" data-path="respr-and-the-tidyverse.html"><a href="respr-and-the-tidyverse.html#working-in-the-tidyverse"><i class="fa fa-check"></i><b>15.1</b> Working in the Tidyverse</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="a-comparison-of-respr-with-other-r-packages.html"><a href="a-comparison-of-respr-with-other-r-packages.html"><i class="fa fa-check"></i><b>16</b> A comparison of respR with other R packages</a></li>
<li class="chapter" data-level="17" data-path="when-to-use-respr.html"><a href="when-to-use-respr.html"><i class="fa fa-check"></i><b>17</b> When to use respR</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">respR – R Package Documentation</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="intermittent-flow-respirometry-simple-example" class="section level1">
<h1><span class="header-section-number">9</span> Intermittent-flow respirometry: Simple example</h1>
<!-- ## Intermittent-flow respirometry -->
<!-- Intermittent-flow respirometry involves obtaining multiple replicates in an experiment by periodically flushing the respirometer with fresh treatment water or air after a set period of time or O~2~ decrease.  -->
<!-- Typically, the oxygen sensing system is left recording during flushes so the system returning to normoxia can be seen in the data.  -->
<!-- If the dataset is not split into the separate replicates, this results in an dataset with oscillating levels of oxygen.  -->
<!-- This vignette shows a simple example of how an intermittent-flow respirometry experiment can be analysed in `respR`. Another [example is provided](https://januarharianto.github.io/respR/articles/intermittent2.html) to show how a longer, more complex intermittent-flow experiment with differing background rates can be analysed. -->
<!-- ## A relatively simple example -->
<!-- The example data, `intermittent.rd`, contains intermittent-flow measurements of oxygen consumption in the sea urchin *Heliocidaris erythrogramma*.  -->
<!-- Detailed information about the data, including its source and methods, can be obtained with the command `?intermittent.rd`.  -->
<!-- We use `inspect()` to scan for errors in the data frame, preview the data and save it to an object to pass to the next stage. -->
<!-- ```{r eval = F} -->
<!-- urchin_int <- inspect(intermittent.rd) -->
<!-- ``` -->
<!-- ```{r echo = F, warning=FALSE} -->
<!-- inspect(intermittent.rd) -->
<!-- ``` -->
<!-- ```{r echo = F, fig.keep = "none", message = FALSE, results = "hide"} -->
<!-- urchin_int <- inspect(intermittent.rd) -->
<!-- ``` -->
<!-- We can see from the top plot that this dataset has three replicates. The flush periods obviously skew the bottom plot which shows rate of change in O~2~ concentration over a rolling window of 20% of the data, however uptake rates (flat regions) appear to be consistent within each experimental replicate.  -->
<!-- ## Analysis with calc_rate() -->
<!-- In the near future `respR` will support intermittent-flow data directly with a dedicated function to easily identify and subset replicates, but at present intermittent data can be analysed quite easily via the main `calc_rate()` function with a little organisation. -->
<!-- ### Subsetting by row and time -->
<!-- The `calc_rate` function supports input of multiple subset regions by `row` or `time`. The `from` and `to` operators can be vectors with paired values: -->
<!-- ```{r fig.width=7, fig.height=3.5} -->
<!-- urchin_int_rates <- calc_rate(urchin_int, from = c(200, 2300, 4100), to = c(1800, 3200, 4600), by = "time") -->
<!-- print(urchin_int_rates) -->
<!-- ``` -->
<!-- Calling `summary()` will show the coefficients and locations of each subset: -->
<!-- ```{r} -->
<!-- summary(urchin_int_rates) -->
<!-- ``` -->
<!-- We can also use `plot()` to view the diagnostic plots of any individual replicate. The argument `rep` determines which data subset to plot: -->
<!-- ```{r} -->
<!-- plot(urchin_int_rates, rep = 2) -->
<!-- ``` -->
<!-- We can even query multiple regions of each replicate (which can overlap, although this would obscure the output plot somewhat): -->
<!-- ```{r fig.width=7, fig.height=3.5} -->
<!-- calc_rate(urchin_int, from = c(200, 900, 2300, 2900, 4000, 4400), to = c(700, 1700, 2700, 3300, 4300, 4700), by = "time") -->
<!-- ``` -->
<!-- ### Extracting rate results  -->
<!-- Rates can be easily extracted for further analysis or selection. For instance, we may be interested in the lowest rate, the one most representative of basal metabolic rates. Of course because rates are negative, the minimum *value* in negative terms would actually represent the highest rate, so we should extract the maximum (least negative) value, or transform the rates first:  -->
<!-- ```{r} -->
<!-- urchin_int_rates$rate -->
<!-- min(-1*urchin_int_rates$rate) -->
<!-- ``` -->
<!-- Or, we may be more interested in the mean rate: -->
<!-- ```{r} -->
<!-- mean(urchin_int_rates$rate) -->
<!-- ``` -->
<!-- ### Subsetting by oxygen  -->
<!-- If we are interested in looking at rates over particular oxygen ranges within each replicate, `calc_rate()` will find the first match to the range entered: -->
<!-- ```{r fig.width=7, fig.height=3.5} -->
<!-- calc_rate(urchin_int, from = 7, to = 6.6, by = "o2") -->
<!-- ``` -->
<!-- To examine the same range in each replicate, we can follow a number of approaches. We can call the data range containing another replicate directly from the original dataset, or data frame saved within the `inspect()` object: -->
<!-- ```{r fig.keep="none"} -->
<!-- calc_rate(intermittent.rd[2100:3500,], from = 7, to = 6.6, by = "o2") -->
<!-- calc_rate(urchin_int$dataframe[2100:3500,], from = 7, to = 6.6, by = "o2") -->
<!-- ``` -->
<!-- ```{r echo=F, message=FALSE, warning=FALSE, results = "hide", fig.width=7, fig.height=3.5} -->
<!-- calc_rate(urchin_int$dataframe[2100:3500,], from = 7, to = 6.6, by = "o2") -->
<!-- ``` -->
<!-- Or we can subset them manually into new dataframes, and process them separately through the entire workflow. Here we use the dedicated `subset_data()` function in `respR`, which allows easy subsetting by time, oxygen or row number. For best results, these should exclude the flush periods.  -->
<!-- ```{r fig.keep="none", message=FALSE, warning=FALSE, results="hide"} -->
<!-- # Create separate replicate data frames -->
<!-- u_rep1 <- subset_data(intermittent.rd, from = 1, to = 1900, by = "time") -->
<!-- u_rep2 <- subset_data(intermittent.rd, from = 2100, to = 3500, by = "time") -->
<!-- u_rep3 <- subset_data(intermittent.rd, from = 3700, to = 4831, by = "time") -->
<!-- # Process one in `inspect()` (output not shown) -->
<!-- u_rep3_c <- inspect(u_rep3) -->
<!-- ``` -->
<!-- ```{r fig.width=7, fig.height=3.5} -->
<!-- calc_rate(u_rep3_c, from = 7, to = 6.6, by = "o2") -->
<!-- ``` -->
<!-- ## Analysis with auto_rate() -->
<!-- To more rigourously identify minimum, maximum or most linear rates we can use the `auto_rate()` function, however because this does not support (as yet) subsetting internally, each replicate must be subset and analysed separately. See other vignettes for more detail on using `auto_rate()`.  -->
<!-- ```{r results="hide"} -->
<!-- ## subset first replicate -->
<!-- u_rep1 <- subset_data(intermittent.rd, from = 0, to = 1900, by = "time") -->
<!-- ``` -->
<!-- ```{r results="hide"} -->
<!-- ## analyse in auto_rate -->
<!-- auto_rate(u_rep1) #default = most linear rate -->
<!-- auto_rate(u_rep1, method = "min") # minimum rate -->
<!-- ``` -->
<!-- ## Background adjustments -->
<!-- For background adjustments, the `adjust_rate()` function can be used on `calc_rate` objects containing multiple rate values: -->
<!-- ```{r} -->
<!-- urchin_int_rates_adj <- adjust_rate(urchin_int_rates, by = -0.00005) -->
<!-- urchin_int_rates_adj$input.rate -->
<!-- urchin_int_rates_adj$corrected -->
<!-- ``` -->
<!-- We can see each individual rate has been adjusted, and the new rates can be extracted from the resulting object using `$corrected`.  -->
<!-- ## Converting rates -->
<!-- Once the rates have been determined, they can be converted to volume-corrected or mass-specific rates using `convert_rate()`.  -->
<!-- ```{r tidy = F} -->
<!-- u_rates_final <- convert_rate(urchin_int_rates_adj,  -->
<!--                               o2.unit = "mg/L",  -->
<!--                               time.unit = "s",  -->
<!--                               output.unit = "mg/h/g",  -->
<!--                               volume = 2.379,  -->
<!--                               mass = 0.006955) -->
<!-- ``` -->
<!-- Only the first rate converted rate is shown in the output, but all rates determined are converted and can be extracted. -->
<!-- ```{r} -->
<!-- u_rates_final$input -->
<!-- u_rates_final$output -->
<!-- ``` -->
<!-- ## More complex intermittent-flow experiments -->
<!-- A more complex intermittent-flow analysis is provided [here](https://januarharianto.github.io/respR/articles/intermittent2.html). -->

</div>
            </section>

          </div>
        </div>
      </div>
<a href="comparative-performance-of-auto-rate-and-lolinr.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="intermittent-flow-respirometry-complex-example.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["respR_documentation.pdf", "respR_documentation.epub"],
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
